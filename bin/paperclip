#!/usr/bin/env node
var argv = require('optimist').
usage('Usage: $0 -i [paperclip_template_file] -o [js_file]').
demand(['i']).
alias('i', 'input').
alias('w', 'watch').
describe('p', 'pretty-print template output').
describe('i', 'paperclip template source').
argv,
path = require("path"),
parser = require("../lib/parser"),
parser = require("../lib/parser2/parser"),
formatter = require("../lib/parser/formatter"),
fs = require("fs");

try {
  console.log("%s ...", argv.i);

  try {
    var source = fs.readFileSync(argv.i, "utf8"),
    script = parser.parse(source).toJavaScript();

    if (argv.p) {
      script = formatter.format(script);
    } 

    // console.log(script);
  } catch (e) {
    console.error(e.stack);
  }

} catch (e) {
  console.log(e);
}


// console.log(script)