// Generated by CoffeeScript 1.6.2
var BlockWriter, ElementWriter, FragmentWriter, Loader, TextWriter, modifiers;

modifiers = require("./defaultModifiers");

FragmentWriter = require("./writers/fragment");

BlockWriter = require("./writers/block");

TextWriter = require("./writers/text");

ElementWriter = require("./writers/element");

Loader = (function() {
  /*
  */
  function Loader(template) {
    this.template = template;
    this.nodeFactory = template.nodeFactory;
    this.paper = template.paper;
    this.bindings = [];
    this._writers = {
      fragment: new FragmentWriter(this),
      block: new BlockWriter(this),
      text: new TextWriter(this),
      element: new ElementWriter(this)
    };
  }

  /*
  */


  Loader.prototype.load = function(context) {
    var binding, _i, _len, _ref;

    this.context = context;
    this.node = this.paper(this._writers.fragment.write, this._writers.block.write, this._writers.element.write, this._writers.text.write, modifiers);
    _ref = this.bindings;
    for (_i = 0, _len = _ref.length; _i < _len; _i++) {
      binding = _ref[_i];
      binding.load(context);
    }
    return this;
  };

  /*
  */


  Loader.prototype.bind = function() {
    var binding, _i, _len, _ref;

    _ref = this.bindings;
    for (_i = 0, _len = _ref.length; _i < _len; _i++) {
      binding = _ref[_i];
      binding.bind(context);
    }
    return this;
  };

  /*
  */


  Loader.prototype.toString = function() {
    return this.node.toString();
  };

  return Loader;

})();

module.exports = Loader;
