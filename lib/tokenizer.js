// Generated by CoffeeScript 1.6.2
(function() {
  var Codes, Tokenizer, key, strscan;

  strscan = require("strscanner");

  Codes = (function() {
    function Codes() {}

    Codes.OTHER = -1;

    Codes.WORD = 1;

    Codes.STRING = Codes.WORD << 1;

    Codes.WS = Codes.STRING << 1;

    Codes.DOLLAR = 36;

    Codes.LP = 40;

    Codes.RP = 41;

    Codes.COMA = 44;

    Codes.DOT = 46;

    Codes.COLON = 58;

    Codes.SEMI_COLON = 59;

    Codes.AT = 64;

    Codes.LB = 123;

    Codes.PIPE = 124;

    Codes.RB = 125;

    return Codes;

  })();

  for (key in Codes) {
    Codes[Codes[key]] = Codes[key];
  }

  /*
  
  1. check if word. If word, then eval until /}|,/
  value = parse("name")
  */


  Tokenizer = (function() {
    /*
    */
    Tokenizer.prototype.codes = Codes;

    /*
    */


    function Tokenizer() {
      this._s = strscan("", {
        skipWhitespace: false
      });
    }

    /*
    */


    Tokenizer.prototype.source = function(value) {
      if (!arguments.length) {
        return this._source;
      }
      this._s.source(this._source = value);
      return this;
    };

    /*
    */


    Tokenizer.prototype.nextToken = function() {
      var buffer, c, ccode, cscode;

      if (this._s.eof()) {
        return null;
      }
      if (this._s.isAZ()) {
        return this._t(Codes.WORD, this._s.nextWord());
      } else if ((ccode = this._s.ccode()) === 39 || ccode === 34) {
        buffer = [];
        while ((c = this._s.nextChar()) && !this._s.eof()) {
          cscode = this._s.ccode();
          if (cscode === 92) {
            buffer.push(this._s.nextChar());
            continue;
          }
          if (cscode === ccode) {
            break;
          }
          buffer.push(c);
        }
        return this._t(Codes.STRING, buffer.join(""));
      } else if (this._s.isWs()) {
        return this._t(Codes.WS, this._s.next(/[\s\r\n\t]+/));
      }
      return this._t(Codes[ccode] || Codes.OTHER, this._s.cchar());
    };

    /*
    */


    Tokenizer.prototype._t = function(code, value) {
      this._s.nextChar();
      return [code, value];
    };

    return Tokenizer;

  })();

  module.exports = new Tokenizer();

}).call(this);
